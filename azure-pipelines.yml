trigger:
  branches:
    include:
      - main

pool:
  vmImage: 'ubuntu-latest'

steps:
- checkout: self

- task: UseSSH@0
  inputs:
    sshEndpoint: 'adventour-ssh-connection'  # ğŸ‘ˆ must match the name of your SSH service connection
    runOptions: 'inline'
    inline: |
      echo "ğŸ” Pulling latest code..."
      cd /home/azureuser/adventour-backend || exit 1
      git pull origin main

      echo "ğŸ›‘ Stopping old containers..."
      docker-compose down

      echo "ğŸš€ Building and starting containers..."
      docker-compose up -d --build

      echo "âœ… Deployment complete!"
